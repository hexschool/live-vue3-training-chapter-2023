import{f as _,h as F,r as b,o as r,c as u,b as o,a as e,F as I,k as U,i as v,t as m,w as q,d as x,l as g,j as E,v as L}from"./index-95744fc7.js";import{a as V}from"./axios-3a76d256.js";const M={class:"about"},N=e("h1",null,"This is 購物車頁面",-1),j={class:"container"},B={class:"row justify-content-center"},S={class:"col-md-6"},T={class:"table align-middle"},D=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"110px"}},"數量"),e("th",null,"單價")])],-1),R=["onClick","disabled"],z={key:0,class:"fas fa-spinner fa-pulse"},O={key:0,class:"text-success"},A={class:"input-group input-group-sm"},G={class:"text-end"},H={key:0,class:"text-success"},J=e("td",{colspan:"3",class:"text-end"},"總計",-1),K={class:"text-end"},P={key:0},Q=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),W={class:"text-end text-success"},X={class:"my-5 row justify-content-center"},Y={class:"mb-3"},Z=e("label",{for:"email",class:"form-label"},"Email",-1),ee={class:"mb-3"},se=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),te={class:"mb-3"},ae=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),le={class:"mb-3"},oe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ne={class:"mb-3"},de=e("label",{for:"message",class:"form-label"},"留言",-1),ce=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1),me={__name:"UserCart",setup(ie){const y=_(null),h=_({loadingItem:""}),c=_(!1),n=_({}),a=_({user:{name:"",email:"",tel:"",address:""},message:""}),k=()=>{c.value=!0;const i="https://vue3-course-api.hexschool.io/v2/api/hexschoolvue/cart";V.get(i).then(s=>{s.data.success?(n.value=s.data.data,c.value=!1):alert(s.data.message)})},C=i=>{c.value=!0;const s=`https://vue3-course-api.hexschool.io/v2/api/hexschoolvue/cart/${i}`;h.value.loadingItem=i,V.delete(s).then(d=>{alert(d.data.message),k()}).catch(d=>{alert(d.response.data.message)}),h.value.loadingItem="",c.value=!1},$=()=>{c.value=!0;const i="https://vue3-course-api.hexschool.io/v2/api/hexschoolvue/order",s=a.value;V.post(i,{data:s}).then(d=>{alert(d.data.message),y.value.resetForm(),c.value=!1}).catch(d=>{alert(d.response.data.message)})};return F(()=>{k()}),(i,s)=>{const d=b("VueLoading"),p=b("VeeField"),f=b("ErrorMessage"),w=b("VeeForm");return r(),u("div",M,[o(d,{active:c.value},null,8,["active"]),N,e("div",j,[e("div",B,[e("div",S,[e("table",T,[D,e("tbody",null,[n.value.carts?(r(!0),u(I,{key:0},U(n.value.carts,t=>(r(),u("tr",{key:t.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:l=>C(t.id),disabled:h.value.loadingItem===t.id},[h.value.loadingItem===t.id?(r(),u("i",z)):v("",!0),x(" 移除購物車 ")],8,R)]),e("td",null,[x(m(t.product.title)+" ",1),t.coupon?(r(),u("div",O," 已套用優惠券 ")):v("",!0)]),e("td",null,[e("div",A,m(t.qty)+" / "+m(t.product.unit),1)]),e("td",G,[n.value.final_total!==n.value.total?(r(),u("small",H,"折扣價：")):v("",!0),x(" "+m(t.final_total),1)])]))),128)):v("",!0)]),e("tfoot",null,[e("tr",null,[J,e("td",K,m(n.value.total),1)]),n.value.final_total!==n.value.total?(r(),u("tr",P,[Q,e("td",W,m(n.value.final_total),1)])):v("",!0)])])])]),e("div",X,[o(w,{ref_key:"formRef",ref:y,class:"col-md-6",onSubmit:$},{default:q(({errors:t})=>[e("div",Y,[Z,o(p,{id:"email",name:"email",type:"email",class:g(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.value.user.email,"onUpdate:modelValue":s[0]||(s[0]=l=>a.value.user.email=l)},null,8,["class","modelValue"]),o(f,{name:"email",class:"invalid-feedback"})]),e("div",ee,[se,o(p,{id:"name",name:"姓名",type:"text",class:g(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:a.value.user.name,"onUpdate:modelValue":s[1]||(s[1]=l=>a.value.user.name=l)},null,8,["class","modelValue"]),o(f,{name:"姓名",class:"invalid-feedback"})]),e("div",te,[ae,o(p,{id:"tel",name:"電話",type:"text",class:g(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",rules:"required",modelValue:a.value.user.tel,"onUpdate:modelValue":s[2]||(s[2]=l=>a.value.user.tel=l)},null,8,["class","modelValue"]),o(f,{name:"電話",class:"invalid-feedback"})]),e("div",le,[oe,o(p,{id:"address",name:"地址",type:"text",class:g(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:a.value.user.address,"onUpdate:modelValue":s[3]||(s[3]=l=>a.value.user.address=l)},null,8,["class","modelValue"]),o(f,{name:"地址",class:"invalid-feedback"})]),e("div",ne,[de,E(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=l=>a.value.message=l)},null,512),[[L,a.value.message]])]),ce]),_:1},512)])])])}}};export{me as default};
